# Реакция на MALICIOUS Software (Вредоносное ПО)

## ПОДГОТОВКА

## ОБНАРУЖЕНИЕ
Determine fully if a malicious code outbreak has occurred

The objective of this step is to determine whether a malicious code outbreak has occurred. Typical indications of a malicious code outbreak include any or all the following:

Users complain of slow access to the Internet, exhaustion of system resources, slow disk access, or slow system boots.

A number of alerts have been generated by a Host-based Intrusion Detection System (HIDS), or by anti-virus or malicious code detection software.

There is significantly increased network usage.

A number of access violation entries have been noticed in perimeter router logs or firewall logs.

A surge of out-bounced SMTP traffic originating from an internal IP addresses has been detected.

A large number of port scans and failed connection attempts have been detected.

The system administrator notices an unusual deviation from typical network traffic flows.

Security controls such as anti-virus software and personal firewalls have been disabled on many hosts.

General system instability and crashes.

Upon discovery of any of the above symptoms, IT staff should immediately check and validate all suspicious activity to determine if an outbreak has occurred. Once it is confirmed that this is a malicious code security breach, it is important to collect information about the malicious code, as this will be essential for the containment and eradication process.

Information about the malicious code can be obtained from anti-virus software vendors' websites if the malicious code has been around for some time, by reviewing alerts from anti-virus and malicious code detection software, by examining firewall and router log files. The following questions can help identify the characteristics of the malicious code:

What kind of malicious code is it (Network worm, mass-mailing worm, virus, or trojan horse etc.)?

How does the malicious code propagate (By attacking vulnerable network service? By mass mailing?)

If the malicious code propagates by attacking vulnerable service, what is the vulnerability being exploited? Has a patch for addressing the vulnerability been released? What are the services or ports that are being attacked?

Does the malicious code plant backdoors on the infected system?

How can the malicious code be removed from the affected system? Are there any removal tools available?

Perform preliminary assessments

Once an outbreak is identified, IT staff should assess the scope, damage and impact of the outbreak in order to effectively deal with it.

Record all actions taken

IT staff should record all actions taken to deal with the outbreak and any corresponding results. This can facilitate incident identification and assessment, and provide evidence for prosecution or other useful information for subsequent incident handling stages. Logging should be carried out throughout the whole security incident response process.

## СДЕРЖИВАНИЕ

The second step in incident response is to notify all appropriate parties and escalate the incident to the appropriate level following a predefined escalation procedure. The information provided during the escalation process should be clear, concise, accurate and factual. Providing inaccurate, misleading or incomplete information may hinder the response process or may even worsen the situation. It is crucial to bear in mind that information about incident should be disclosed only on a need to know basis.

## ВОССТАНОВЛЕНИЕ

he third step of response to a malicious code incident is containment. The following are activities that should be carried out in the containment stage:

Identify infected systems
Clearly identifying the infected systems is always the first step in containment. Unfortunately it is also a very complicated process due to the dynamic nature of today's IT environment. The following are some suggestions that may help identify infected systems in a managed environment:

Perform thorough virus scanning on all the systems with the latest virus signatures as well as with updated anti-virus detection and repair engines. As no single anti-virus software or malicious code detection tool can uncover all types of malicious code, it may be necessary to use more than one anti-virus scanning tool to ensure that all malicious codes are detected.

Review all log files of routers and firewalls.

Provide users with instructions on how to identify infections.

Configure IPS or IDS to identify activities associated with infections.

Perform packet sniffing routines to look for the network traffic matching the characteristics of the malicious code.

Contain the outbreak
Containing the outbreak can be done in various ways; the following are common tactics:

By using automated tools
Containing the spread of the malicious code can be done with automated tools, such as anti-virus software or malicious code detection tools, IDS and IPS. If the malicious code is not detected by existing anti-virus protection systems, even with the latest signature applied, support from anti-virus software vendors should be sought to create a new signature which covers the malicious code.

By disabling connectivity
A malicious code outbreak can be effectively contained by quickly disconnecting infected systems from the overall network infrastructure, which can be accomplished by applying access controls on network devices or physically disconnecting network cables. In some cases, in order to contain the spread of malicious code to other sections of the organisation, it may be necessary to temporarily disconnect the network segments concerned from the network backbone. However, this containment strategy will certainly affect the operation of other non-infected systems in the segment.

By disabling services
Malicious code may propagate through network services, for example network shared drives. Temporarily blocking or even shutting down the network services used by malicious codes helps to contain incidents.

By eliminating vulnerability
Malicious code may spread by attacking vulnerable network services. By addressing the vulnerabilities that have been exploited by the malicious code, such as applying security patches on vulnerable systems, the propagation channels can be eliminated, hence containing the spread. In addition, some mis-configuration, such as loose access controls on network-shared drives, can also be leveraged by malicious code. By rectifying any mis-configurations, the spread of a malicious code can be contained.

By user participation
User participation is significant to the containment process in an environment where only a limited number of technical support staff are available to handle an outbreak, for example in small remote branch offices or in a non-managed office environment. Users should be provided with clear instructions on how to identify infections and what measures should be taken if a system is confirmed infected, such as running the anti-virus removal tools on the infected system.

Keep records of all actions taken
It is important to keep a solid record of all actions taken at this stage, because some containment measures may require temporary modifications to the configuration or settings of network infrastructure and systems. These modifications will need to be removed after the incident.

It is important to understand that stopping further infection by the malicious code does not necessarily prevent the further damage to infected systems. For instance, the infection can be contained through disabling network connectivity. Yet, the malicious code may be still actively deleting files on the infected system. Therefore, a full eradication process should be carried out as soon as possible or in parallel with the containment process.

Recovery
Clearly, the main purpose of the recovery step is to restore all systems to normal operation. In a malicious code outbreak, recovering the functionality and data of infected systems may have already been carried as part of the eradication process. Apart from restoring the infected systems, removing any temporary containment measures, such suspended network connections, is another main aspect of the recovery process.

Prior to removal of the containment measures, one important step is a pre-production security risk assessment to ensure that no infection is detected, and that the cause of the original infection is rectified.

All related parties should be notified before the resumption of suspended services. IT personnel should restore specific functions and servers stage by stage, in a controlled manner, and in the order of demand, e.g. the most essential services or those serving the majority should resume first. After resuming the suspended services, it is important to verify that the restoration operation has been successful and that all services are back to normal operation. Additional monitoring measures may be implemented to watch for any suspicious activity in the network segments concerned.

## ВЫВОДЫ
